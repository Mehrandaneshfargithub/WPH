@model WPH.Models.Reception.ReceptionViewModel

@using Microsoft.AspNetCore.Http
@inject IHttpContextAccessor HttpContextAccessor
@inject WPH.Resources.SharedViewLocalizer Localizer


@{
    string font = "", pull = "", dir = "";
    string padding1 = "";
    string padding2 = "";

    if (HttpContextAccessor.HttpContext.Session.GetString("culture") == "en")
    {
        font = " MyFont-Roboto-grid ";
        pull = " pull-right ";
        padding1 = " padding-right:0px; ";
        padding2 = " padding-left:0px; ";
        dir = " ";

        <input class="hidden" type="text" id="RTL" data-Value="False" />
        <h3 id="newAmbulanceText" class="hidden">@Localizer["New"] @Localizer["Ambulance"]</h3>
        <h3 id="newServiceText" class="hidden">@Localizer["New"] @Localizer["Service"]</h3>
    }
    else
    {
        font = " MyFont-Sarchia-grid ";
        pull = " pull-left ";
        padding1 = " padding-left:0px; ";
        padding2 = " padding-right:0px; ";
        dir = " direction:rtl; ";

        <input class="hidden" type="text" id="RTL" data-Value="True" />
        <h3 id="newAmbulanceText" class="hidden">@Localizer["Ambulance"] @Localizer["New"]</h3>
        <h3 id="newServiceText" class="hidden">@Localizer["Service"] @Localizer["New"]</h3>
    }
}




@Html.AntiForgeryToken()
@Html.HiddenFor(m => m.Guid, new { id = "Guid" })
@Html.HiddenFor(m => m.Id, new { id = "Id" })
@Html.HiddenFor(m => m.CreatedUserId, new { id = "CreatedUserId" })
@Html.HiddenFor(m => m.PatientId, new { id = "PatientId" })
@Html.HiddenFor(m => m.EntranceDate, new { id = "EntranceDate" })
@Html.HiddenFor(m => m.ExitDate, new { id = "ExitDate" })
@Html.HiddenFor(m => m.Patient.AddressId, new { id = "AddressId" })
@Html.HiddenFor(m => m.Patient.DateOfBirthDay, new { id = "DateOfBirthDay" })
@Html.HiddenFor(m => m.Patient.DateOfBirthMonth, new { id = "DateOfBirthMonth" })
@Html.HiddenFor(m => m.Patient.DateOfBirthYear, new { id = "DateOfBirthYear" })
@Html.HiddenFor(m => m.ReceptionNum, new { id = "ReceptionNum" })
@Html.HiddenFor(m => m.ReceptionDate, new { id = "ReceptionDate" })
@Html.HiddenFor(m => m.ReceptionTypeId, new { id = "ReceptionTypeId" })
@Html.HiddenFor(m => m.PaymentStatusId, new { id = "StatusId" })
@Html.HiddenFor(m => m.Emergency.Guid, new { id = "EmergencyId" })
<h3 class="hidden" id="SurgeryOneVal"></h3>
<h3 class="hidden" id="DispatcherDoctorVal"></h3>



<style>

    .OtherCheckbox {
        font-family: 'Times New Roman', Times, serif;
        font-size: 1.5rem;
        padding: 0.5rem 0;
        font-weight: bolder;
    }

        .OtherCheckbox:hover {
            background-color: rgba(86, 250, 15,0.2);
            border-radius: 0.7rem;
            cursor: pointer;
        }

    .kendoCheckbox {
        font-family: 'Times New Roman', Times, serif;
        font-size: 1.5rem;
        padding: 0.5rem 0;
        font-weight: bolder;
    }

        .kendoCheckbox:hover {
            background-color: rgba(86, 250, 15,0.2);
            border-radius: 0.7rem;
            cursor: pointer;
        }

    .activeCheckbox {
        background-color: greenyellow;
        border-radius: 0.7rem;
        border: solid rgb(56, 176, 4) 2px;
    }

    .k-primary {
        padding: 0.5rem;
    }

        .k-primary:hover {
            cursor: pointer;
            text-decoration: none;
        }

        .k-primary a:hover {
            cursor: pointer;
            text-decoration: none;
        }

    .clearfix label {
        font-size: 1.5rem;
        font-weight: bold;
    }

    .OddDivs {
    }


    li span.k-link {
        color: rgba(0,0,0,0.7) !important;
    }

        li span.k-link:hover {
            color: white !important;
        }

    .k-pager-nav {
        background-color: rgba(0, 0, 51,0.8) !important;
    }

    span.k-pager-input {
        color: rgba(0,0,0,0.7) !important;
    }

    span.k-pager-info {
        color: rgba(0,0,0,0.7) !important;
    }

    new-btn-color {
        background-color: rgba(52, 86, 139,0.8) !important;
        color: white !important;
    }



    /*k-primary {
                                                                                                                                            background-color: #34568b !important;
                                                                                                                                            color: white !important;
                                                                                                                                        }*/

    .modal-open {
        padding-right: 0 !important
    }

    .boldText {
        font-weight: 900 !important;
        color: black !important;
    }


    .analysisButtons {
        background-color: rgba(0, 0, 51,0.8);
        border-radius: 1rem;
        padding: 0.5rem;
        transition: all 0.3s;
        font-weight: 300 !important;
    }

        .analysisButtons:hover {
            background-color: #34568b;
            text-decoration: none;
            cursor: pointer;
            transition: all 0.3s;
        }

    .k-tabstrip-wrapper li .k-link {
        color: white !important;
    }

    .k-tabstrip-wrapper li.k-state-active .k-link {
        color: black !important;
    }

        .k-tabstrip-wrapper li.k-state-active .k-link:hover {
            color: white !important;
        }
</style>


<input id="Translated" class="hidden" data-TotalTranslated="@Localizer["Total"]" data-DiscountTranslated="@Localizer["Discount"]" data-PriceTranslated="@Localizer["Price"]"
       data-CodeTranslated="@Localizer["Code"]" data-TypeTranslated="@Localizer["Type"]" data-NameTranslated="@Localizer["Name"]" data-AmountTranslated="@Localizer["Amount"]"
       data-DateTranslated="@Localizer["Date"]" />

<h3 class="hidden" id="Reception-Id">@ViewBag.ReceptionId</h3>


<div id="allPage" class="row @font" style="@dir">

    <div class="col-sm-12" style="margin:1rem 0;border-bottom:1px dotted rgba(0,0,0,0.3);padding-bottom:2rem">

        <div class="pull-left">

            <h3 class="MyFont-Roboto-grid" style="direction:ltr">Date: <span id="reception-date" class="pull-right" style="color: #34568b; direction: ltr"> @DateTime.Now.Day / @DateTime.Now.Month / @DateTime.Now.Year </span></h3>

        </div>

        <div class="pull-left" style="margin-left: 1rem">

            <h3 class="MyFont-Roboto-grid">InvoiceNum: <i id="reception-num" style="color:#34568b">@Model.ReceptionNum</i></h3>

        </div>

        <div class="pull-right @font">

            <a class="k-primary " style="padding: 0.8rem; font-weight: 400; margin-right: 0.5rem" onclick="OkAndNew()">@Localizer["Ok"] @Localizer["And"] @Localizer["New"]</a>

        </div>

        <div class="pull-right">

            <a class="k-primary  " style="padding:0.8rem;font-weight:400;margin-right:0.5rem" onclick="OkAndExit()">@Localizer["Ok"] @Localizer["And"] @Localizer["Exit"]</a>

        </div>

        <div class="pull-right">

            <a class="k-primary " style="padding:0.8rem;margin-right:0.5rem;font-weight:400" onclick="Exit()">@Localizer["Exit"]</a>

        </div>

        <div class="pull-right">

            <a class="k-primary " style="padding:0.8rem;margin-right:0.5rem;font-weight:400" onclick="PrintReception()">@Localizer["Print"]</a>

        </div>

    </div>

    <h3 id="useDollar" class="hidden"></h3>

    <h3 id="Emergency" class="hidden">@ViewBag.Emergency</h3>

    <h3 id="clinicSection" class="hidden"></h3>

    <div class="col-sm-12 shadow-border" style="margin:0.1rem 0;">

        <div class="col-sm-12">

            <div class="col-lg-3 col-md-4 col-sm-6">

                <label class="block clearfix">
                    <span class="red fa fa-asterisk smaller-60 redStar"></span>
                    <label id="PatientNameLabel" for="form-field-8">@Localizer["PatientName"]</label>
                    <span class="block input-icon input-icon-right">

                        <script>

                            function OnPatientSelectInEmergencyReception(e) {

                                var DataItem = this.dataItem(e.item.index());
                                var id = this.element.attr('id');

                                $('span.saved_attachments_image_container').remove();
                                setFileCount();
                                readImagesFromServer("/PatientImage/GetMainPatientImageByPatientId?patientId=" + DataItem.Guid, "main_attachments_img", "lbl_main_attachments_count");

                                readImagesFromServer("/PatientImage/GetPolicReportPatientImageByPatientId?patientId=" + DataItem.Guid, "polic_report_attachments_img", "lbl_polic_report_attachments_count");

                                $("#DateOfBirth").val(DataItem.DateOfBirth);
                                $("#PhoneNumber").val(DataItem.PhoneNumber);
                                $("#AddressName").val(DataItem.AddressName);
                                $("#AddressId").val(DataItem.AddressId);
                                $("#PatientId").val(DataItem.Guid);
                                $("#MotherName").val(DataItem.MotherName);
                                var dropdownlist = $("#GenderId").data("kendoDropDownList");

                                dropdownlist.value(DataItem.GenderId);

                                $("#DateOfBirth").focus();

                                setTimeout(function () {
                                    $("#Name2").val(DataItem.Name);
                                    $("#PatientAttendanceName").focus();

                                    //setTimeout(function () {
                                    //    let value = doctorAuto.value();
                                    //    doctorAuto.search(value);
                                    //}, 30);

                                }, 20);

                            }

                        </script>

                        <input id="Name2" style="width:100%;margin:0" data_checkEmpty="Name2-box" class="boldText" />

                    </span>
                    <span id="Name2-box" class="emptybox hidden" data-isEssential="true" style="color: red; ">
                        @Localizer["ThisFieldIsEmptyPleaseFillIt"]
                    </span>

                </label>

            </div>

            <div class="col-lg-3 col-md-4 col-sm-6">

                <label class="block clearfix">
                    <label for="form-field-8">@Localizer["Mobile"]</label>
                    <span class="block input-icon input-icon-right">

                        <input id="PhoneNumber" class="boldText" validate-mobile="Mobile-wrong"  style="width: 100%; margin: 0"  onkeypress="return OnlyNumberKey(event)" />
                    </span>
                    <span id="Mobile-wrong" class="hidden" style="color:red;">
                        @Localizer["MobileNotCorrect"]
                    </span>
                </label>

            </div>

            <div class="col-lg-3 col-md-4 col-sm-6">

                <label class="block clearfix">
                    <label for="form-field-8">@Localizer["Gender"]</label>
                    <span class="block input-icon input-icon-right">

                        <input id="GenderId" style="width:100%;margin:0" class="boldText" />

                    </span>

                </label>

            </div>

            <div class="col-lg-3 col-md-4 col-sm-6">

                <label class="block clearfix">
                    <label for="form-field-8">@Localizer["IdentityNumber"]</label>
                    <span class="block input-icon input-icon-right">

                        <input id="IdentityNumber" style="width:100%;margin:0" class="boldText" />

                    </span>

                </label>

            </div>



        </div>

        <div class="col-sm-12">

            <div class="col-lg-3 col-md-4 col-sm-6">

                <label class="block clearfix">
                    <label for="form-field-8">@Localizer["DateOfBirth"]</label>
                    <span class="block input-icon input-icon-right">

                        <input id="DateOfBirth" class="boldText" title="datepicker" style="width: 100%; margin: 0" onchange="dateTimePickerWorkWithSpace(this)" />

                    </span>

                </label>

            </div>

            <div class="col-lg-3 col-md-4 col-sm-6">

                <label class="block clearfix">

                    <label for="form-field-8" style="width:100%">@Localizer["Age"]</label>

                    <span style="width:25%">
                        <label for="form-field-8">@Localizer["Year"]: </label>

                        <input id="Year" class="boldText" style="width: 25%;margin:0;padding:0" onkeypress="return OnlyNumberKey(event)" onchange="ReserveInsertAge(this)" />

                    </span>

                    <span style="width:25%">

                        <label for="form-field-8">@Localizer["Month"]: </label>

                        <input id="Month" class="boldText" style="width: 25%;margin:0;padding:0" onkeypress="return OnlyNumberKey(event)" onchange="ReserveInsertAge(this)" />

                    </span>

                </label>

            </div>

            <div class="col-lg-3 col-md-4 col-sm-6">

                <label class="block clearfix">
                    <label id="DoctorNameLabel" for="form-field-8">@Localizer["Address"]</label>
                    <span class="block input-icon input-icon-right " onkeydown="">

                        <script>

                            function OnSelectAddress(e) {
                                var DataItem = this.dataItem(e.item.index());
                                $("#AddressId").val(DataItem.Guid);
                                $('#MotherName').focus();

                            }

                        </script>

                        <input id="AddressName" style="width:100%;margin:0" class="boldText" />

                    </span>


                </label>

            </div>


            <div class="col-lg-3 col-md-4 col-sm-6">

                <label class="block clearfix">
                    <label for="form-field-8">@Localizer["Name"] @Localizer["Mother"]</label>
                    <span class="block input-icon input-icon-right ">

                        <input id="MotherName" style="width:100%;margin:0" class="boldText" />

                    </span>

                </label>

            </div>

        </div>

            <div class="col-sm-12">

                <div class="col-lg-3 col-md-4 col-sm-6">

                    <label class="block clearfix">
                        <label for="form-field-8">@Localizer["Name"] @Localizer["PatientAttendant"]</label>
                        <span class="block input-icon input-icon-right ">

                            <input id="PatientAttendanceName" style="width:100%;margin:0" class="boldText" />

                        </span>

                    </label>

                </div>

                <div class="col-lg-3 col-md-4 col-sm-6">

                    <label class="block clearfix">
                        <label for="form-field-8">@Localizer["Section"]</label>
                        <span class="block input-icon input-icon-right">

                            @(Html.Kendo().DropDownList()
                            .Name("ClinicSectionId")
                            .DataTextField("Name")
                            .DataValueField("Guid")
                            .Value(Model.ClinicSectionId.ToString())
                            .DataSource(source =>
                            {
                            source.Read(read =>
                            {
                            read.Action("GetAllNormalClinicSectionsForUser", "ClinicSection");
                            })
                            .ServerFiltering(false);
                            })
                            .HtmlAttributes(new { style = "width: 100%;" })

                            )
                        </span>
                    </label>

                </div>

                <script>
                    let reception_id = $("#Reception-Id").text();
                    var first = true;
                    function FilterRoomBed() {

                        return {
                            ClinicSectionId: $("#ClinicSectionId").val()
                        };
                    }

                    function RoomBedIdBound() {


                        if (first) {
                            first = false;

                            $.ajax({
                                type: "Post",
                                data: { ReceptionId: reception_id },
                                url: "/ReceptionRoomBed/GetReceptionRoomBedId",
                                success: function (response) {
                                    
                                    if (response != "" && response.Name != "") {
                                        var room_bed = $("#RoomBedId").data("kendoDropDownList");
                                        var dataSource = room_bed.dataSource;

                                        dataSource.add({
                                            Guid: response.Guid,
                                            RoomBedName: response.RoomBedName
                                        });

                                        setTimeout(function () {

                                            room_bed.value(response.Guid);

                                        }, 500);

                                    }

                                    $(".loader").fadeIn("slow");
                                    $(".loader").addClass("hidden");

                                }
                            });
                        }

                    }

                </script>

                <div id="RoomBedParent" class="col-lg-3 col-md-4 col-sm-6">

                    <label class="block clearfix">
                        <label for="form-field-8">@Localizer["RoomBed"]</label>

                        <span class="block input-icon input-icon-right">

                            @{
                                <a href="\\#" class="  @pull btn btn-danger" onclick="SelectRoomBed()" style="padding:0 0.2rem"><span class="k-icon k-i-plus" style="margin:0.1rem"></span></a>

                            }

                            @(Html.Kendo().DropDownList()
                            .Name("RoomBedId")
                            .DataTextField("RoomBedName")
                            .DataValueField("Guid")
                            .OptionLabel(" ")
                            .DataSource(source =>
                            {
                            source.Read(read =>
                            {
                            read.Action("GetEmptyBedByClinicSectionId", "RoomBed").Data("FilterRoomBed");
                            })
                            .ServerFiltering(true);
                            })
                            .Events(e => e.DataBound("RoomBedIdBound"))
                            //.Enable(false)
                            .AutoBind(false)
                            .Filter("contains")
                            .CascadeFrom("ClinicSectionId")
                            .HtmlAttributes(new { style = "width: 85%;" })
                            )
                        </span>
                    </label>

                </div>

                @*<div id="RoomBedNameParent" class="col-lg-3 col-md-4 col-sm-6 hidden">

                        <label class="block clearfix">
                            <label for="form-field-8">@Localizer["RoomBed"]</label>

                            <span class="block input-icon input-icon-right ">

                                <input id="RoomBedName" style="width:100%;margin:0" class="boldText" />

                            </span>
                        </label>

                    </div>*@

                <div class="col-lg-3 col-md-4 col-sm-6" >
                    <input type="file" name="mainAttachmentsUpload" value="" id="mainAttachmentsUpload" multiple="" style="display: none;">
                    <label class="block clearfix">
                        <label for="form-field-8">@Localizer["IdentityImage"]</label>

                        <span class="block input-icon input-icon-right">

                            <a href="\\#" class="k-primary k-button" id="main_attachments" style="padding: 0.3rem 0.3rem; width: 100%; display: flex; justify-content: space-between; flex-direction: row-reverse; align-items: center;">
                                <span class="fa fa-chevron-up" style="display: block;"></span>
                                <span>
                                    <label id="lbl_main_attachments" style="border: 1px solid #ccc!important;padding: 0.1rem 2rem;display: inline-block;margin: 0px;">@Localizer["SelectImage"]</label>
                                    <label id="lbl_main_attachments_count" style="padding: 0px 3px;display: inline-block;margin: 0px;font-weight: normal;font-size: smaller;">0 file</label>
                                </span>
                            </a>

                        </span>
                    </label>
                    <div id="main_attachments_container" class="col-sm-12" style="position: absolute;z-index: 10;width: 100%;display:none; @padding2">
                        <div id="main_attachments_img" class="k-list-scroller" unselectable="on" style="height: 200px;border: 1px solid #ccc!important;background: white;">
                        </div>
                    </div>

                </div>

                <div class="col-lg-3 col-md-4 col-sm-6" >
                    <input type="file" name="otherAttachmentsUpload" value="" id="otherAttachmentsUpload" multiple="" style="display: none;">
                    <label class="block clearfix">
                        <label for="form-field-8">@Localizer["OtherImage"]</label>

                        <span class="block input-icon input-icon-right">

                            <a href="\\#" class="k-primary k-button" id="other_attachments" style="padding: 0.3rem 0.3rem; width: 100%; display: flex; justify-content: space-between; flex-direction: row-reverse; align-items: center;">
                                <span class="fa fa-chevron-up" style="display: block;"></span>
                                <span>
                                    <label id="lbl_other_attachments" style="border: 1px solid #ccc !important; padding: 0.1rem 2rem; display: inline-block; margin: 0px;">@Localizer["SelectImage"]</label>
                                    <label id="lbl_other_attachments_count" style="padding: 0px 3px;display: inline-block;margin: 0px;font-weight: normal;font-size: smaller;">0 file</label>
                                </span>
                            </a>

                        </span>
                    </label>
                    <div id="other_attachments_container" class="col-sm-12" style="position: absolute;z-index: 10;width: 100%;display:none; @padding2">
                        <div id="other_attachments_img" class="k-list-scroller" unselectable="on" style="height: 200px;border: 1px solid #ccc!important;background: white;">
                        </div>
                    </div>
                </div>

            </div>

            <div class="col-sm-12">

                <div class="col-lg-3 col-md-4 col-sm-6">

                    <script>

                        function GetAllPurpose() {
                            return {
                                BaseInfoGeneralName: "PurposeType"
                            }
                        }

                    </script>

                    <label class="block clearfix">
                        <label for="form-field-8">@Localizer["Purpose"]</label>
                        <span class="block input-icon input-icon-right">

                            @(Html.Kendo().DropDownList()
                            .Name("PurposeId")
                            .DataTextField("Name")
                            .DataValueField("Id")
                            .DataSource(source =>
                            {
                                source.Read(read =>
                                {
                                    read.Action("GetBaseInfoGeneralsByName", "BaseInfo").Data("GetAllPurpose");
                                })
                                .ServerFiltering(false);
                            })
                            .Value(Model.PurposeId.ToString())
                            .HtmlAttributes(new { style = "width: 100%;", onchange = "PurposeChange()" })
                            )
                        </span>
                    </label>

                </div>


                <div class="col-lg-3 col-md-4 col-sm-6 hidden observationSection">

                    <label class="block clearfix">
                        <span class="red fa fa-asterisk smaller-60 redStar"></span>
                        <label for="form-field-8">@Localizer["Price"] @Localizer["Visit"]</label>
                        <span class="block input-icon input-icon-right">

                            @(Html.Kendo().NumericTextBox<decimal>()
                                    .Name("PriceVisit")
                                    .Min(0)
                                    .Format("#.00")
                                    .Value(Model.PriceVisit)
                                .HtmlAttributes(new { @style = "width:100%;margin:0px;", @class = "boldText" })
                            )


                        </span>
                        <span id="PriceVisit-box" class="emptybox hidden" style="color:red;">
                            @Localizer["ThisFieldIsEmptyPleaseFillIt"]
                        </span>
                    </label>

                </div>


                <div class="col-lg-3 col-md-4 col-sm-6 hidden serviceSection">

                    <label class="block clearfix">
                        <label for="form-field-8">@Localizer["Service"]</label>
                        <span class="block input-icon input-icon-right">

                            <a href="\\#" class="  @pull btn btn-danger" onclick="NewCustomService()" style=" padding:0 0.2rem;"><span class="fa fa-plus" style="margin:0.1rem"></span></a>

                            <input id="Service" style="width:90%;margin:0" class="boldText" />

                        </span>
                    </label>

                </div>

                <div class="col-lg-3 col-md-4 col-sm-6 hidden serviceSection">

                    <label class="block clearfix">
                        <label for="form-field-8">@Localizer["Number"]</label>
                        <span class="block input-icon input-icon-right">

                            <input id="ServiceNumber" style="width:100%;margin:0" class="boldText" />

                        </span>
                    </label>

                </div>

                <script>

                    function OnSurgeryOneSelect(e) {

                        var DataItem = this.dataItem(e.item.index());

                        $("#SurgeryOneVal").text(DataItem.Guid);


                    }

                </script>

                <script>

                    function OnDispatcherDoctorSelect(e) {

                        var DataItem = this.dataItem(e.item.index());

                        $("#DispatcherDoctorVal").text(DataItem.Guid);


                    }

                </script>


                <div class="col-lg-3 col-md-4 col-sm-6 hidden surgerySection">

                    <label class="block clearfix">
                        <span class="red fa fa-asterisk smaller-60 redStar"></span>
                        <label for="form-field-8">@Localizer["SurgeryDoctor"]</label>
                        <span class="block input-icon input-icon-right">

                            <input id="SurgeryOne" style="width:100%;margin:0" class="boldText" />

                        </span>
                        <span id="SurgeryOne-box" class="emptybox hidden" style="color:red;">
                            @Localizer["ThisFieldIsEmptyPleaseFillIt"]
                        </span>
                    </label>

                </div>

                <div class="col-lg-3 col-md-4 col-sm-6 hidden surgerySection">

                    <label class="block clearfix">
                        <label for="form-field-8">@Localizer["DispatcherDoctor"]</label>
                        <span class="block input-icon input-icon-right">

                            <input id="DispatcherDoctor" style="width:100%;margin:0" class="boldText" />

                        </span>

                    </label>

                </div>



                <div class="col-lg-3 col-md-4 col-sm-6 hidden surgerySection">

                    <label class="block clearfix">
                        <label for="form-field-8">@Localizer["Operation"]</label>
                        <span class="block input-icon input-icon-right">

                            <a href="\\#" class="  @pull btn btn-danger" onclick="NewOperation()" style=" padding:0 0.2rem;"><span class="fa fa-plus" style="margin:0.1rem"></span></a>

                            <input id="Operation" style="width:90%;margin:0" class="boldText" />

                        </span>
                    </label>

                </div>

                <div class="col-lg-3 col-md-4 col-sm-6 hidden surgerySection">

                    <label class="block clearfix">
                        <label for="form-field-8">@Localizer["Date"] @Localizer["Operation"]</label>
                        <span class="block input-icon input-icon-right">

                            <input id="datetimepicker" style="width:100%;margin:0" class="boldText" title="datetimepicker" />

                        </span>
                    </label>

                </div>

            </div>

        

        @{
            var emerge = "hidden";
            if (ViewBag.Emergency)
            {

                emerge = "";

            }
        }

        <div class="col-sm-12 @emerge">

            <div class="col-lg-3 col-md-4 col-sm-6">

                <label class="block clearfix">
                    <label for="form-field-8">@Localizer["Type"] @Localizer["Arrival"]</label>
                    <span class="block input-icon input-icon-right " onkeydown="">

                        <script>

                            function selectArrival(e) {

                                if (e.dataItem.Name === "Ambulance") {

                                    $("#ambulanceSection").removeClass('hidden');

                                }
                                else {
                                    $("#ambulanceSection").addClass('hidden');
                                }

                            }

                        </script>

                        <input id="ArrivalId" style="width:100%;margin:0" class="boldText" />

                    </span>

                </label>

            </div>

            <div class="col-lg-3 col-md-4 col-sm-6">

                <label class="block clearfix">
                    <label for="form-field-8">@Localizer["Type"] @Localizer["Critical"]</label>
                    <span class="block input-icon input-icon-right " onkeydown="">

                        <input id="CriticallyId" style="width:100%;margin:0" class="boldText" />

                    </span>

                </label>

            </div>

        </div>

        <div id="ambulanceSection" class="col-sm-12 hidden">

            <div class="col-lg-3 col-md-4 col-sm-6">

                <label class="block clearfix">
                    <label for="form-field-8">@Localizer["Ambulance"]</label>
                    <span class="block input-icon input-icon-right ">

                        <a href="\\#" class="  @pull btn btn-danger" onclick="NewAmbulance()" style=" padding:0 0.2rem;"><span class="fa fa-plus" style="margin:0.1rem"></span></a>

                        <input id="AmbulanceId" style="width:90%;margin:0" class="boldText" />

                    </span>

                </label>

            </div>

            <div class="col-lg-3 col-md-4 col-sm-6">

                <label class="block clearfix">
                    <label for="form-field-8">@Localizer["From"] @Localizer["Hospital"]</label>
                    <span class="block input-icon input-icon-right ">

                        <input id="FromHospitalName" style="width:100%;margin:0" class="boldText" />

                    </span>

                </label>

            </div>

            <div class="col-lg-3 col-md-4 col-sm-6">

                <label class="block clearfix">
                    <label for="form-field-8">@Localizer["To"] @Localizer["Hospital"]</label>
                    <span class="block input-icon input-icon-right ">

                        <input id="ToHospitalName" style="width:100%;margin:0" class="boldText" />

                    </span>

                </label>

            </div>

            <div class="col-lg-3 col-md-4 col-sm-6">

                <label class="block clearfix">
                    <label for="form-field-8">@Localizer["PatientHealth"]</label>
                    <span class="block input-icon input-icon-right ">

                        <input id="PatientHealthId" style="width:100%;margin:0" class="boldText" />

                    </span>

                </label>

            </div>

            <div class="col-lg-3 col-md-4 col-sm-6">

                <label class="block clearfix">
                    <label for="form-field-8">@Localizer["Cost"]</label>
                    <span class="block input-icon input-icon-right ">

                        <input id="Cost" style="width:100%;margin:0" class="boldText" />

                    </span>

                </label>

            </div>



            <div class="col-lg-3 col-md-4 col-sm-6 currencyId hidden">

                <label class="block clearfix">
                    <label for="form-field-8">@Localizer["Currency"]</label>
                    <span class="block input-icon input-icon-right ">

                        <input id="CostCurrencyId" style="width:100%;margin:0" class="boldText" />

                    </span>

                </label>

            </div>

            <div class="col-sm-12">

                <label class="block clearfix">
                    <label for="form-field-8">@Localizer["Explanation"] @Localizer["Ambulance"]</label>
                    <span class="block input-icon input-icon-right ">

                        <textarea id="AmbulanceExplanation" style="width: 100%;"></textarea>

                    </span>

                </label>

            </div>

        </div>


        <div class="col-sm-12 ">

            <div class="col-lg-3 col-md-4 col-sm-6">
                <input type="file" name="policReportAttachmentsUpload" value="" id="policReportAttachmentsUpload" multiple="" style="display: none;">
                <label class="block clearfix">
                    <label for="form-field-8">@Localizer["PoliceReport"]</label>

                    <span class="block input-icon input-icon-right">

                        <a href="\\#" class="k-primary k-button" id="polic_report_attachments" style="padding: 0.3rem 0.3rem; width: 100%; display: flex; justify-content: space-between; flex-direction: row-reverse; align-items: center;">
                            <span class="fa fa-chevron-up" style="display: block;"></span>
                            <span>
                                <label id="lbl_polic_report_attachments" style="border: 1px solid #ccc !important; padding: 0.1rem 2rem; display: inline-block; margin: 0px;">@Localizer["SelectImage"]</label>
                                <label id="lbl_polic_report_attachments_count" style="padding: 0px 3px;display: inline-block;margin: 0px;font-weight: normal;font-size: smaller;">0 file</label>
                            </span>
                        </a>

                    </span>
                </label>
                <div id="polic_report_attachments_container" class="col-sm-12" style="position: absolute;z-index: 10;width: 100%;display:none; @padding2">
                    <div id="polic_report_attachments_img" class="k-list-scroller" unselectable="on" style="height: 200px;border: 1px solid #ccc!important;background: white;">
                    </div>
                </div>

            </div>

        </div>




        <div class="col-sm-12 ">

            <div class="col-sm-12 ">

                <label class="block clearfix">
                    <label for="form-field-8">@Localizer["Explanation"]</label>
                    <span class="block input-icon input-icon-right ">

                        <textarea id="Description" style="width: 100%;"></textarea>

                    </span>

                </label>

            </div>

        </div>

    </div>


    <div class="col-sm-12 @font" style="margin:2rem 0">


        <div class=" @pull">

            <a href="#" id="btnOkNew" class="k-primary " style="padding: 0.8rem; font-weight: 400; margin-right: 0.5rem" onclick="OkAndNew()">@Localizer["Ok"] @Localizer["And"] @Localizer["New"]</a>

        </div>


        <div class=" @pull">

            <a href="#" id="btnOkExit" class="k-primary " style="padding:0.8rem;font-weight:400;margin-right:0.5rem" onclick="OkAndExit()">@Localizer["Ok"] @Localizer["And"] @Localizer["Exit"]</a>

        </div>

        <div class=" @pull">

            <a href="#" id="btnExit" class="k-primary " style="padding:0.8rem;margin-right:0.5rem;font-weight:400" onclick="Exit()">@Localizer["Exit"]</a>

        </div>

        <div class=" @pull">

            <a href="#" id="btnExit" class="k-primary " style="padding:0.8rem;margin-right:0.5rem;font-weight:400" onclick="PrintReception()">@Localizer["Print"]</a>

        </div>

        <div style="clear:both;@dir">

            <div id="ERROR_WrongReception" class="red label-white middle hidden" style="height:40px;display:block">
                <i class="ace-icon fa fa-stop bigger-120"></i>
                @Localizer["ERROR_InsertWrong"]
            </div>

        </div>

    </div>

</div>


<div id="SelectRoomBedModal" class="modal fade @font" data-backdrop="static" data-keyboard="false" style="@dir">
    <div class="modal-dialog" style="width:90%;">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" onclick="closeSelectRoomBedModal()" aria-hidden="true">&times;</button>
                <h3 id="SelectRoomBedModal-header" class="smaller lighter blue no-margin @font">
                    @Localizer["RoomManagement"]
                </h3>
            </div>

            <div id="SelectRoomBedModal-body" class="modal-body">
            </div>

            <div id="Bed_Select" class="red label-white middle hidden" style="height:40px;display:block">
                <i class="ace-icon fa fa-stop bigger-120"></i>
                @Localizer["BedNotSelected"]
            </div>
            <div id="ERROR_SomeThingWentWrong" class="red label-white middle hidden" style="height:40px;display:block">
                <i class="ace-icon fa fa-stop bigger-120"></i>
                @Localizer["ERROR_SomeThingWentWrong"]
            </div>
            <div class="modal-footer">
                @(Html.Kendo().Button()
                .Name("btn-selectRoomBed-accept")
                .HtmlAttributes(new { style = "font-size:15px;height:35px;margin:2px;", type = "button", @class = "k-primary pull-right hidden", onclick = "selectNewRoomBed()" })
                .Content(Localizer["Ok"]))
                @(Html.Kendo().Button()
                .Name("btn-selectRoomBed-close")
                .HtmlAttributes(new { style = "font-size:15px;height:35px;margin:2px;", type = "button", @class = "pull-right", onclick="closeSelectRoomBedModal()" })
                .Content(Localizer["Exit"]))
            </div>
        </div> @*.modal-content*@
    </div> @*.modal-dialog*@
</div>

<div id="ConfirmSelectPatientBedModal" class="modal fade @font" data-backdrop="static" data-keyboard="false" style="@dir">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" onclick="closeConfirmSelectPatientBedModal()" aria-hidden="true">&times;</button>

                <h3 class='smaller @font'>
                    <i class='ace-icon fa fa-exclamation-triangle red '></i>@Localizer["Warning"]
                </h3>
            </div>

            <div id="ConfirmSelectPatientBedModal-body" class="modal-body">
                <span id="ChangePatientBed" class="hidden">@Localizer["ChangePatientBed"]</span>
                <span id="ChangeBedPatient" class="hidden">@Localizer["ChangeBedPatient"]</span>
                <span id="SwapPatientsBeds" class="hidden">@Localizer["SwapPatientsBeds"]</span>
            </div>

            <div class="modal-footer">

                @(Html.Kendo().Button()
                .Name("btn-confirmAddPatientBed-accept")
                .HtmlAttributes(new { style = "font-size:15px;height:35px;margin:2px;", type = "button", @class = "k-primary pull-right", onclick = "confirmSelectPatientBedModal()" })
                .Content(Localizer["Yes"]))
                @(Html.Kendo().Button()
                .Name("btn-confirmAddPatientBed-close")
                .HtmlAttributes(new { style = "font-size:15px;height:35px;margin:2px;", type = "button", @class = "pull-right", onclick="closeConfirmSelectPatientBedModal()" })
                .Content(Localizer["No"]))
            </div>
        </div> @*.modal-content*@
    </div> @*.modal-dialog*@
</div>

<div id="DeleteSavedAttachmentModal" class="modal fade @font" data-backdrop="static" data-keyboard="false" style="@dir">
    <div class="modal-dialog modal-sm">
        <div class="modal-content">
            <div class="widget-header" style="padding:1rem">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                <h3 class='smaller @font'>
                    <i class='ace-icon fa fa-exclamation-triangle red '></i>@Localizer["DeleteRecordHeader"]
                </h3>
            </div>

            <div id="DeleteSavedAttachmentModal-body" class="modal-body">
                @Localizer["DeleteRecordBody"]

                <div id="ERROR_ThisRecordHasDependencyOnItInAnotherEntity" class="red label-white middle hidden" style="height:40px;display:block;margin-top:2rem">
                    <i class="ace-icon fa fa-stop bigger-120"></i>
                    @Localizer["ERROR_ThisRecordHasDependencyOnItInAnotherEntity"]
                </div>

                <div id="ERROR_SomeThingWentWrong" class="red label-white middle hidden" style="height:40px;display:block">
                    <i class="ace-icon fa fa-stop bigger-120"></i>
                    @Localizer["ERROR_SomeThingWentWrong"]
                </div>
            </div>

            <div class="modal-footer">

                @(Html.Kendo().Button()
                .Name("btn-deleteSavedAttachment-accept")
                .HtmlAttributes(new { style = "font-size:15px;height:35px;margin:2px;", type = "button", @class = "k-primary pull-right" })
                .Content(Localizer["Ok"]))
                @(Html.Kendo().Button()
                .Name("btn-deleteSavedAttachment-close")
                .HtmlAttributes(new { style = "font-size:15px;height:35px;margin:2px;", type = "button", @class = "pull-right", @data_dismiss = "modal" })
                .Content(Localizer["Exit"]))
            </div>
        </div> @*.modal-content*@
    </div> @*.modal-dialog*@
</div>

<input class="hidden" type="text" id="TempRoomBedId" />

<div id="snackbar">
    <span>
        @Localizer["BedSelected"]
    </span>
</div>




<div style="display:flex;direction:ltr">

    @(Html.Kendo().Window()
    .Name("window")
    .Visible(false)
    .Content(@<text>
            <div id="imageEditor"></div>
            @*<img id="imagePreview" src="#" alt="Image Preview" height="500" />*@
        </text>)
    .Draggable()
    .Resizable()
    .Actions(actions => actions.Pin().Minimize().Maximize().Close())
    .HtmlAttributes(new { style = "display:flex;direction:ltr" })
    )

</div>

<div id="CreateNewAmbulanceModal" class="modal fade @font" data-backdrop="static" data-keyboard="false" style="@dir">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" onclick="closeCreateNewAmbulanceModal()" aria-hidden="true">&times;</button>
                <h3 id="CreateNewAmbulanceModal-header" class="smaller lighter blue no-margin @font">
                </h3>
            </div>

            <div id="CreateNewAmbulanceModal-body" class="modal-body">
            </div>

            <div id="ERROR_Data" class="red label-white middle hidden" style="height:40px;display:block">
                <i class="ace-icon fa fa-stop bigger-120"></i>
                @Localizer["ERROR_DataNotValid"]
            </div>

            <div id="ERROR_SomeThingWentWrong" class="red label-white middle hidden" style="height:40px;display:block">
                <i class="ace-icon fa fa-stop bigger-120"></i>
                @Localizer["ERROR_InsertWrong"]
            </div>

            <div class="modal-footer">
                @(Html.Kendo().Button()
                .Name("btn-CreateNewAmbulanceModal-accept")
                .HtmlAttributes(new { style = "font-size:15px;height:35px;margin:2px;", type = "button", @class = "k-primary pull-right" })
                .Content(Localizer["Ok"]))
                @(Html.Kendo().Button()
                .Name("btn-CreateNewAmbulanceModal-close")
                .HtmlAttributes(new { style = "font-size:15px;height:35px;margin:2px;", type = "button", @class = "pull-right", onclick = "closeCreateNewAmbulanceModal()" })
                .Content(Localizer["Exit"]))
            </div>
        </div>
    </div>
</div>

<div id="CreateNewOperationModal" class="modal fade @font" data-backdrop="static" data-keyboard="false" style="@dir">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" onclick="closeCreateNewOperationModal()" aria-hidden="true">&times;</button>
                <h3 id="CreateNewOperationModal-header" class="smaller lighter blue no-margin @font">
                </h3>
            </div>

            <div id="CreateNewOperationModal-body" class="modal-body">
            </div>

            <div id="ERROR_Data" class="red label-white middle hidden" style="height:40px;display:block">
                <i class="ace-icon fa fa-stop bigger-120"></i>
                @Localizer["ERROR_DataNotValid"]
            </div>

            <div id="ERROR_SomeThingWentWrong" class="red label-white middle hidden" style="height:40px;display:block">
                <i class="ace-icon fa fa-stop bigger-120"></i>
                @Localizer["ERROR_InsertWrong"]
            </div>

            <div class="modal-footer">
                @(Html.Kendo().Button()
                .Name("btn-CreateNewOperationModal-accept")
                .HtmlAttributes(new { style = "font-size:15px;height:35px;margin:2px;", type = "button", @class = "k-primary pull-right" })
                .Content(Localizer["Ok"]))
                @(Html.Kendo().Button()
                .Name("btn-CreateNewOperationModal-close")
                .HtmlAttributes(new { style = "font-size:15px;height:35px;margin:2px;", type = "button", @class = "pull-right", onclick = "closeCreateNewOperationModal()" })
                .Content(Localizer["Exit"]))
            </div>
        </div>
    </div>
</div>

<div id="CreateNewCustomServiceModal" class="modal fade @font" data-backdrop="static" data-keyboard="false" style="@dir">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" onclick="closeCreateNewCustomServiceModal()" aria-hidden="true">&times;</button>
                <h3 id="CreateNewCustomServiceModal-header" class="smaller lighter blue no-margin @font">
                </h3>
            </div>

            <div id="CreateNewCustomServiceModal-body" class="modal-body">
            </div>

            <div id="ERROR_Data" class="red label-white middle hidden" style="height:40px;display:block">
                <i class="ace-icon fa fa-stop bigger-120"></i>
                @Localizer["ERROR_DataNotValid"]
            </div>

            <div id="ERROR_SomeThingWentWrong" class="red label-white middle hidden" style="height:40px;display:block">
                <i class="ace-icon fa fa-stop bigger-120"></i>
                @Localizer["ERROR_InsertWrong"]
            </div>

            <div class="modal-footer">
                @(Html.Kendo().Button()
                .Name("btn-CreateNewCustomServiceModal-accept")
                .HtmlAttributes(new { style = "font-size:15px;height:35px;margin:2px;", type = "button", @class = "k-primary pull-right" })
                .Content(Localizer["Ok"]))
                @(Html.Kendo().Button()
                .Name("btn-CreateNewCustomServiceModal-close")
                .HtmlAttributes(new { style = "font-size:15px;height:35px;margin:2px;", type = "button", @class = "pull-right", onclick = "closeCreateNewCustomServiceModal()" })
                .Content(Localizer["Exit"]))
            </div>
        </div>
    </div>
</div>

<script src="~/Content/Js/ReceptionNew.js"></script>

<script>
    function NewAmbulance() {

        $("#CreateNewAmbulanceModal #ERROR_Data").addClass("hidden");
        $("#CreateNewAmbulanceModal #ERROR_SomeThingWentWrong").addClass("hidden");

        var link = "/Ambulance/AddAndNewModal";
        $(".loader").removeClass("hidden");

        let header = $("#newAmbulanceText").text();
        $('#CreateNewAmbulanceModal-header').text(header);

        $('#CreateNewAmbulanceModal').modal('toggle');
        $('#CreateNewAmbulanceModal-body').load(link + '', function () {
            $(".loader").fadeIn("slow");
            $(".loader").addClass("hidden");
        });

    }

    $('#btn-CreateNewAmbulanceModal-accept').on("click", function () {
        $(this).attr("disabled", true);

        $("#CreateNewAmbulanceModal #ERROR_Data").addClass("hidden");
        $("#CreateNewAmbulanceModal #ERROR_SomeThingWentWrong").addClass("hidden");

        $('#CreateNewAmbulanceModal .emptybox').addClass('hidden');
        var isEmmpty = true;
        $('#CreateNewAmbulanceModal .emptybox').each(function () {
            if ($(this).attr('data-isEssential') === 'true') {
                var empty = $(this).attr('id');
                if ($('[data-checkEmpty="' + empty + '"]').val() === "") {
                    $(this).removeClass('hidden');
                    $('#btn-CreateNewAmbulanceModal-accept').removeAttr("disabled");
                    isEmmpty = false;
                    return;
                }
            }
        });

        if (isEmmpty === false) {
            return;
        }

        var link = "/Ambulance/AddOrUpdate";
        var data = $("#addNewAmbulanceForm").serialize();

        $(".loader").removeClass("hidden");
        $.ajax({
            type: "Post",
            url: link,
            data: data,
            success: function (response) {
                $('#btn-CreateNewAmbulanceModal-accept').removeAttr("disabled");

                if (response !== 0) {
                    if (response === "ValueIsRepeated") {

                        $('#CreateNewAmbulanceModal #Name-Exist').removeClass('hidden');

                        $(".loader").fadeIn("slow");
                        $(".loader").addClass("hidden");
                    } else if (response === "DataNotValid") {

                        $("#CreateNewAmbulanceModal #ERROR_Data").removeClass("hidden");
                        $(".loader").fadeIn("slow");
                        $(".loader").addClass("hidden");

                    } else {

                        $('#CreateNewAmbulanceModal').modal('hide');
                        $(".modal-backdrop:last").remove();
                        $('#CreateNewAmbulanceModal-body').empty();
                        $(".loader").fadeIn("slow");
                        $(".loader").addClass("hidden");

                        $("#AmbulanceId").data("kendoDropDownList").dataSource.read();
                        let pr = $("#AmbulanceId").data("kendoDropDownList");
                        pr.bind("dataBound", function () {
                            pr.value(response);
                        });

                    }
                } else {

                    $("#CreateNewAmbulanceModal #ERROR_SomeThingWentWrong").removeClass("hidden");
                    $(".loader").fadeIn("slow");
                    $(".loader").addClass("hidden");
                }
            }
        });
    });

    function closeCreateNewAmbulanceModal() {

        $('#CreateNewAmbulanceModal').modal('hide');
        $('#CreateNewAmbulanceModal-body').empty();
        $(".modal-backdrop:last").remove();
    }



    function NewOperation() {

        txt = 'Operation';

        $("#CreateNewOperationModal #ERROR_Data").addClass("hidden");
        $("#CreateNewOperationModal #ERROR_SomeThingWentWrong").addClass("hidden");

        var link = `/Service/SingleNewModal?typeName=${txt}`;
        $(".loader").removeClass("hidden");

        let header = $("#newServiceText").text();
        $('#CreateNewOperationModal-header').text(header);

        $('#CreateNewOperationModal').modal('toggle');
        $('#CreateNewOperationModal-body').load(link + '', function () {
            $(".loader").fadeIn("slow");
            $(".loader").addClass("hidden");
        });

    }

    $('#btn-CreateNewOperationModal-accept').on("click", function () {
        $(this).attr("disabled", true);

        $("#CreateNewOperationModal #ERROR_Data").addClass("hidden");
        $("#CreateNewOperationModal #ERROR_SomeThingWentWrong").addClass("hidden");

        $('#CreateNewOperationModal .emptybox').addClass('hidden');
        var isEmmpty = true;
        $('#CreateNewOperationModal .emptybox').each(function () {
            if ($(this).attr('data-isEssential') === 'true') {
                var empty = $(this).attr('id');
                if ($('[data-checkEmpty="' + empty + '"]').val() === "") {
                    $(this).removeClass('hidden');
                    $('#btn-CreateNewOperationModal-accept').removeAttr("disabled");
                    isEmmpty = false;
                    return;
                }
            }
        });

        if (isEmmpty === false) {
            return;
        }


        var link = "/Service/AddOrUpdate";
        var data = $("#addNewServiceForm").serialize();

        $(".loader").removeClass("hidden");
        $.ajax({
            type: "Post",
            url: link,
            data: data,
            success: function (response) {
                $('#btn-CreateNewOperationModal-accept').removeAttr("disabled");

                if (response !== 0) {
                    if (response === "ValueIsRepeated") {

                        $('#CreateNewOperationModal #Name-Exist').removeClass('hidden');
                        $(".loader").fadeIn("slow");
                        $(".loader").addClass("hidden");
                    } else if (response === "DataNotValid") {

                        $("#CreateNewOperationModal #ERROR_Data").removeClass("hidden");
                        $(".loader").fadeIn("slow");
                        $(".loader").addClass("hidden");

                    } else {

                        $('#CreateNewOperationModal').modal('hide');
                        $(".modal-backdrop:last").remove();
                        $('#CreateNewOperationModal-body').empty();
                        $(".loader").fadeIn("slow");
                        $(".loader").addClass("hidden");

                        $("#Operation").data("kendoDropDownList").dataSource.read();
                        let pr = $("#Operation").data("kendoDropDownList");
                        pr.bind("dataBound", function () {
                            pr.value(response);
                        });
                    }
                } else {

                    $("#CreateNewOperationModal #ERROR_SomeThingWentWrong").removeClass("hidden");
                    $(".loader").fadeIn("slow");
                    $(".loader").addClass("hidden");
                }
            }
        });
    });

    function closeCreateNewOperationModal() {

        $('#CreateNewOperationModal').modal('hide');
        $('#CreateNewOperationModal-body').empty();
        $(".modal-backdrop:last").remove();
    }



    function NewCustomService() {
        $("#CreateNewCustomServiceModal #ERROR_Data").addClass("hidden");
        $("#CreateNewCustomServiceModal #ERROR_SomeThingWentWrong").addClass("hidden");

        var link = `/Service/CustomNewModal`;
        $(".loader").removeClass("hidden");

        let header = $("#newServiceText").text();
        $('#CreateNewCustomServiceModal-header').text(header);

        $('#CreateNewCustomServiceModal').modal('toggle');
        $('#CreateNewCustomServiceModal-body').load(link + '', function () {
            $(".loader").fadeIn("slow");
            $(".loader").addClass("hidden");
        });

    }

    $('#btn-CreateNewCustomServiceModal-accept').on("click", function () {
        $(this).attr("disabled", true);

        $("#CreateNewCustomServiceModal #ERROR_Data").addClass("hidden");
        $("#CreateNewCustomServiceModal #ERROR_SomeThingWentWrong").addClass("hidden");

        $('#CreateNewCustomServiceModal .emptybox').addClass('hidden');
        var isEmmpty = true;
        $('#CreateNewCustomServiceModal .emptybox').each(function () {
            if ($(this).attr('data-isEssential') === 'true') {
                var empty = $(this).attr('id');
                if ($('[data-checkEmpty="' + empty + '"]').val() === "") {
                    $(this).removeClass('hidden');
                    $('#btn-CreateNewCustomServiceModal-accept').removeAttr("disabled");
                    isEmmpty = false;
                    return;
                }
            }
        });

        if (isEmmpty === false) {
            return;
        }


        var link = "/Service/AddOrUpdate";
        var data = $("#addNewServiceForm").serialize();

        $(".loader").removeClass("hidden");
        $.ajax({
            type: "Post",
            url: link,
            data: data,
            success: function (response) {
                $('#btn-CreateNewCustomServiceModal-accept').removeAttr("disabled");

                if (response !== 0) {
                    if (response === "ValueIsRepeated") {

                        $('#CreateNewCustomServiceModal #Name-Exist').removeClass('hidden');
                        $(".loader").fadeIn("slow");
                        $(".loader").addClass("hidden");
                    } else if (response === "DataNotValid") {

                        $("#CreateNewCustomServiceModal #ERROR_Data").removeClass("hidden");
                        $(".loader").fadeIn("slow");
                        $(".loader").addClass("hidden");

                    } else {

                        $('#CreateNewCustomServiceModal').modal('hide');
                        $(".modal-backdrop:last").remove();
                        $('#CreateNewCustomServiceModal-body').empty();
                        $(".loader").fadeIn("slow");
                        $(".loader").addClass("hidden");

                        $("#Service").data("kendoDropDownList").dataSource.read();
                        let pr = $("#Service").data("kendoDropDownList");
                        pr.bind("dataBound", function () {
                            pr.value(response);
                        });
                    }
                } else {

                    $("#CreateNewCustomServiceModal #ERROR_SomeThingWentWrong").removeClass("hidden");
                    $(".loader").fadeIn("slow");
                    $(".loader").addClass("hidden");
                }
            }
        });
    });

    function closeCreateNewCustomServiceModal() {

        $('#CreateNewCustomServiceModal').modal('hide');
        $('#CreateNewCustomServiceModal-body').empty();
        $(".modal-backdrop:last").remove();
    }
</script>